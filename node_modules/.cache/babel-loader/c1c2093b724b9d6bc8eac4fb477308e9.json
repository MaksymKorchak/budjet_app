{"ast":null,"code":"const html5rocks = {};\nconst DB_VERSION = 1;\nconst DB_NAME = 'budget';\nhtml5rocks.indexedDB = {};\nhtml5rocks.indexedDB.db = null;\nhtml5rocks.indexedDB.onerror = function (e) {\n  console.log(e);\n};\nfunction open() {\n  return new Promise(function (resolve, reject) {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n    // We can only create Object stores in a versionchange transaction.\n    request.onupgradeneeded = function (e) {\n      const db = e.target.result;\n\n      // A versionchange transaction is started automatically.\n      e.target.transaction.onerror = html5rocks.indexedDB.onerror;\n      if (db.objectStoreNames.contains(DB_NAME)) {\n        db.deleteObjectStore(DB_NAME);\n      }\n      db.createObjectStore(DB_NAME, {\n        keyPath: \"id\"\n      });\n    };\n    request.onsuccess = function (e) {\n      html5rocks.indexedDB.db = e.target.result;\n      resolve();\n    };\n    request.onerror = e => {\n      reject(Error(e));\n    };\n  });\n}\n;\nfunction addItem(item) {\n  return new Promise((resolve, reject) => {\n    const db = html5rocks.indexedDB.db;\n    const trans = db.transaction([DB_NAME], \"readwrite\");\n    const store = trans.objectStore(DB_NAME);\n    const request = store.put(item);\n    request.onsuccess = function (e) {\n      resolve();\n    };\n    request.onerror = function (e) {\n      reject(e);\n    };\n  });\n}\n;\nfunction deleteItem(id) {\n  return new Promise((resolve, reject) => {\n    const db = html5rocks.indexedDB.db;\n    const trans = db.transaction([DB_NAME], \"readwrite\");\n    const store = trans.objectStore(DB_NAME);\n    const request = store.delete(id);\n    request.onsuccess = function (e) {\n      resolve();\n    };\n    request.onerror = function (e) {\n      reject(e);\n    };\n  });\n}\n;\nfunction getItems() {\n  return new Promise((resolve, reject) => {\n    var db = html5rocks.indexedDB.db;\n    if (!db) {\n      reject(Error('No db'));\n    }\n    var trans = db.transaction([DB_NAME], \"readwrite\");\n    var store = trans.objectStore(DB_NAME);\n    const getAllRequest = store.getAll();\n    getAllRequest.onsuccess = function () {\n      resolve(getAllRequest.result);\n    };\n  });\n}\n;\nfunction getData(start, total) {\n  return new Promise(function (resolve, reject) {\n    var db = html5rocks.indexedDB.db;\n    var t = db.transaction([DB_NAME], 'readonly');\n    var store = t.objectStore(DB_NAME);\n    var transactions = [];\n    var hasSkipped = false;\n    store.openCursor(null, 'prev').onsuccess = function (e) {\n      var cursor = e.target.result;\n      if (!hasSkipped && start > 0) {\n        hasSkipped = true;\n        cursor.advance(start);\n        return;\n      }\n      if (cursor) {\n        transactions.push(cursor.value);\n        if (transactions.length < total) {\n          cursor.continue();\n        } else {\n          resolve(transactions);\n        }\n      } else {\n        resolve(transactions);\n      }\n    };\n  });\n}\nconst updateItem = item => addItem(item);\nexport { open, addItem, getItems, deleteItem, updateItem, getData };","map":{"version":3,"names":["html5rocks","DB_VERSION","DB_NAME","indexedDB","db","onerror","e","console","log","open","Promise","resolve","reject","request","onupgradeneeded","target","result","transaction","objectStoreNames","contains","deleteObjectStore","createObjectStore","keyPath","onsuccess","Error","addItem","item","trans","store","objectStore","put","deleteItem","id","delete","getItems","getAllRequest","getAll","getData","start","total","t","transactions","hasSkipped","openCursor","cursor","advance","push","value","length","continue","updateItem"],"sources":["/Users/maksym/Desktop/budjet_app/src/utils/indexdb.js"],"sourcesContent":["const html5rocks = {};\nconst DB_VERSION = 1;\nconst DB_NAME = 'budget';\n\nhtml5rocks.indexedDB = {};\nhtml5rocks.indexedDB.db = null;\n\nhtml5rocks.indexedDB.onerror = function(e) {\n  console.log(e);\n};\n\nfunction open() {\n    return new Promise(function(resolve, reject) {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n        // We can only create Object stores in a versionchange transaction.\n        request.onupgradeneeded = function(e) {\n            const db = e.target.result;\n\n            // A versionchange transaction is started automatically.\n            e.target.transaction.onerror = html5rocks.indexedDB.onerror;\n\n            if(db.objectStoreNames.contains(DB_NAME)) {\n            db.deleteObjectStore(DB_NAME);\n            }\n\n            db.createObjectStore(DB_NAME, {keyPath: \"id\"});\n        };\n\n        request.onsuccess = function(e) {\n            html5rocks.indexedDB.db = e.target.result;\n            resolve()\n        };\n\n        request.onerror = (e) => {\n            reject(Error(e))\n        };\n    })\n};\n\nfunction addItem(item) {\n  return new Promise((resolve, reject) => {\n    const db = html5rocks.indexedDB.db;\n    const trans = db.transaction([DB_NAME], \"readwrite\");\n    const store = trans.objectStore(DB_NAME);\n\n    const request = store.put(item);\n\n    request.onsuccess = function(e) {\n      resolve()\n    };\n\n    request.onerror = function(e) {\n      reject(e)\n    };\n  })\n};\n\nfunction deleteItem(id) {\n  return new Promise((resolve, reject) => {\n    const db = html5rocks.indexedDB.db;\n    const trans = db.transaction([DB_NAME], \"readwrite\");\n    const store = trans.objectStore(DB_NAME);\n  \n    const request = store.delete(id);\n  \n    request.onsuccess = function(e) {\n      resolve()\n    };\n  \n    request.onerror = function(e) {\n      reject(e);\n    };\n  })\n};\n\nfunction getItems() {\n    return new Promise((resolve, reject) => {\n        var db = html5rocks.indexedDB.db;\n        if (!db) {\n            reject(Error('No db'))\n        }\n        var trans = db.transaction([DB_NAME], \"readwrite\");\n        var store = trans.objectStore(DB_NAME);\n\n        const getAllRequest = store.getAll();\n\n        getAllRequest.onsuccess = function() {\n            resolve(getAllRequest.result);\n        }\n    })\n};\n\nfunction getData(start,total) {\n\n\treturn new Promise(function(resolve, reject) {\n    var db = html5rocks.indexedDB.db;\n\t\tvar t = db.transaction([DB_NAME],'readonly');\n\t\tvar store = t.objectStore(DB_NAME);\n\t\tvar transactions = [];\n    var hasSkipped = false;\n    \n\t\tstore.openCursor(null, 'prev').onsuccess = function(e) {\n\n\t\t\tvar cursor = e.target.result;\n\t\t\tif(!hasSkipped && start > 0) {\n\t\t\t\thasSkipped = true;\n\t\t\t\tcursor.advance(start);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(cursor) {\n\t\t\t\ttransactions.push(cursor.value);\n\t\t\t\tif(transactions.length < total) {\n\t\t\t\t\tcursor.continue();\n\t\t\t\t} else {\n\t\t\t\t\tresolve(transactions);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(transactions);\n\t\t\t}\n\t\t};\n\n\t});\n\n}\n\nconst updateItem = (item) => addItem(item);\n\nexport {\n    open,\n    addItem,\n    getItems,\n    deleteItem,\n    updateItem,\n    getData\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}