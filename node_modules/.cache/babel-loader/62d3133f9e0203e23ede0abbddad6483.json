{"ast":null,"code":"import _toConsumableArray from\"/Users/maksym/Desktop/budjet_app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/maksym/Desktop/budjet_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/maksym/Desktop/budjet_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useCallback}from'react';import{STATUSES}from'./constants';import{getData,addItem,deleteItem,updateItem}from'./utils/indexdb';export var useBooleanToggle=function useBooleanToggle(){var initialStatus=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var _useState=useState(initialStatus),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var handleStatusChange=function handleStatusChange(){console.log('switch state');setStatus(function(currrentStatus){return!currrentStatus;});};return{status:status,handleStatusChange:handleStatusChange};};export var useData=function useData(){var _useState3=useState({transactions:[],error:'',status:STATUSES.IDLE,hasNextPage:true,balance:0}),_useState4=_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];useEffect(function(){setState(_objectSpread(_objectSpread({},state),{},{status:STATUSES.PENDING}));getData().then(function(transactions){setState(_objectSpread(_objectSpread({},state),{},{transactions:transactions,status:STATUSES.SUCCESS,hasNextPage:true}));transactions.forEach(function(transaction){return setBalance(transaction);});}).catch(function(e){setState(_objectSpread(_objectSpread({},state),{},{transactions:[],status:STATUSES.ERROR,error:e,hasNextPage:false}));});},[]);var setBalance=function setBalance(transaction){setState(function(state){return _objectSpread(_objectSpread({},state),{},{balance:state.balance+Number(transaction.value)});});};var loadMoreRows=useCallback(function(){setState(_objectSpread(_objectSpread({},state),{},{status:STATUSES.PENDING}));getData(state.transactions.length,20).then(function(transactions){setState(_objectSpread(_objectSpread({},state),{},{transactions:[].concat(_toConsumableArray(state.transactions),_toConsumableArray(transactions)),status:STATUSES.SUCCESS}));}).catch(function(){setState(_objectSpread(_objectSpread({},state),{},{hasNextPage:false}));});},[state]);var pushTransaction=useCallback(function(data){var transaction=_objectSpread(_objectSpread({},data),{},{value:+data.value,id:Date.now()});setState(function(state){return _objectSpread(_objectSpread({},state),{},{balance:state.balance+Number(transaction.value),transactions:[transaction].concat(_toConsumableArray(state.transactions))});});addItem(transaction);},[setState]);var onDelete=useCallback(function(id){var item=state.transactions.find(function(i){return i.id===id;});setState(function(state){return _objectSpread(_objectSpread({},state),{},{balance:state.balance-Number(item.value),transactions:state.transactions.filter(function(item){return item.id!==id;})});});deleteItem(id);},[setState,state]);var onStarClick=useCallback(function(id){var item=state.transactions.find(function(i){return i.id===id;});updateItem(_objectSpread(_objectSpread({},item),{},{isStarred:!item.isStarred})).then(function(){setState(function(state){return _objectSpread(_objectSpread({},state),{},{transactions:state.transactions.map(function(item){return item.id!==id?item:_objectSpread(_objectSpread({},item),{},{isStarred:!item.isStarred});})});});});},[setState,state]);return _objectSpread(_objectSpread({},state),{},{pushTransaction:pushTransaction,onDelete:onDelete,onStarClick:onStarClick,loadMoreRows:loadMoreRows});};","map":{"version":3,"names":["useState","useEffect","useCallback","STATUSES","getData","addItem","deleteItem","updateItem","useBooleanToggle","initialStatus","status","setStatus","handleStatusChange","console","log","currrentStatus","useData","transactions","error","IDLE","hasNextPage","balance","state","setState","PENDING","then","SUCCESS","forEach","transaction","setBalance","catch","e","ERROR","Number","value","loadMoreRows","length","pushTransaction","data","id","Date","now","onDelete","item","find","i","filter","onStarClick","isStarred","map"],"sources":["/Users/maksym/Desktop/budjet_app/src/hooks.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\n\nimport { STATUSES } from './constants';\nimport { getData, addItem, deleteItem, updateItem } from './utils/indexdb'\n\nexport const useBooleanToggle = (initialStatus = false) => {\n    const [status, setStatus] = useState(initialStatus);\n\n    const handleStatusChange = () => {\n        console.log('switch state');\n        setStatus((currrentStatus) => !currrentStatus);\n    };\n\n    return {\n        status,\n        handleStatusChange\n    }\n}\n\nexport const useData = () => {\n    const [state, setState] = useState({\n        transactions: [],\n        error: '',\n        status: STATUSES.IDLE,\n        hasNextPage: true,\n        balance: 0,\n    });\n\n    useEffect(() => {\n        setState({\n            ...state,\n            status: STATUSES.PENDING\n        });\n\n        getData().then((transactions) => {\n            setState({\n                ...state,\n                transactions,\n                status: STATUSES.SUCCESS,\n                hasNextPage: true\n            })\n            transactions.forEach((transaction) => setBalance(transaction))\n        }).catch((e) => {\n            setState({\n                ...state,\n                transactions: [],\n                status: STATUSES.ERROR,\n                error: e,\n                hasNextPage: false\n            })\n        })\n    }, [])\n\n    const setBalance = (transaction) => {\n        setState((state) => ({\n            ...state,\n            balance: state.balance +  Number(transaction.value)\n        }));\n    };\n\n    const loadMoreRows = useCallback(() => {\n        setState({\n            ...state,\n            status: STATUSES.PENDING\n        });\n\n        getData(state.transactions.length, 20).then((transactions) => {\n            setState({\n                ...state,\n                transactions: [...state.transactions, ...transactions],\n                status: STATUSES.SUCCESS\n            })\n        }).catch(() => {\n            setState({\n                ...state,\n                hasNextPage: false\n            })\n        })\n    }, [state])\n\n    const pushTransaction = useCallback((data) => {\n\n        const transaction = {\n            ...data,\n            value: +data.value,\n            id: Date.now()\n        }\n\n        setState((state) => ({\n            ...state,\n            balance: state.balance +  Number(transaction.value),\n            transactions: [transaction, ...state.transactions]\n        }));\n\n        addItem(transaction);\n\n    }, [setState]);\n\n    const onDelete = useCallback((id) => {\n        const item = state.transactions.find((i) => i.id === id);\n\n        setState((state) => ({\n            ...state,\n            balance: state.balance - Number(item.value),\n            transactions: state.transactions.filter((item) => item.id !== id)\n        }));\n\n        deleteItem(id);\n    }, [setState,state]);\n\n    const onStarClick = useCallback((id) => {\n        const item = state.transactions.find((i) => i.id === id);\n        \n        updateItem({\n            ...item,\n            isStarred: !item.isStarred\n        }).then(() => {\n            setState((state) => ({\n                ...state,\n                transactions: state.transactions.map((item) => item.id !== id ? item : {\n                    ...item,\n                    isStarred: !item.isStarred\n                })\n            }))\n        })\n        \n    }, [setState, state])\n\n    return {\n        ...state,\n        pushTransaction,\n        onDelete,\n        onStarClick,\n        loadMoreRows\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}