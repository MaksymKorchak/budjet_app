{"ast":null,"code":"var html5rocks={};var DB_VERSION=1;var DB_NAME='budget';html5rocks.indexedDB={};html5rocks.indexedDB.db=null;html5rocks.indexedDB.onerror=function(e){console.log(e);};function open(){return new Promise(function(resolve,reject){var request=indexedDB.open(DB_NAME,DB_VERSION);// We can only create Object stores in a versionchange transaction.\nrequest.onupgradeneeded=function(e){var db=e.target.result;// A versionchange transaction is started automatically.\ne.target.transaction.onerror=html5rocks.indexedDB.onerror;if(db.objectStoreNames.contains(DB_NAME)){db.deleteObjectStore(DB_NAME);}db.createObjectStore(DB_NAME,{keyPath:\"id\"});};request.onsuccess=function(e){html5rocks.indexedDB.db=e.target.result;resolve();};request.onerror=function(e){reject(Error(e));};});};function addItem(item){return new Promise(function(resolve,reject){var db=html5rocks.indexedDB.db;var trans=db.transaction([DB_NAME],\"readwrite\");var store=trans.objectStore(DB_NAME);var request=store.put(item);request.onsuccess=function(e){resolve();};request.onerror=function(e){reject(e);};});};function deleteItem(id){return new Promise(function(resolve,reject){var db=html5rocks.indexedDB.db;var trans=db.transaction([DB_NAME],\"readwrite\");var store=trans.objectStore(DB_NAME);var request=store.delete(id);request.onsuccess=function(e){resolve();};request.onerror=function(e){reject(e);};});};function getItems(){return new Promise(function(resolve,reject){var db=html5rocks.indexedDB.db;if(!db){reject(Error('No db'));}var trans=db.transaction([DB_NAME],\"readwrite\");var store=trans.objectStore(DB_NAME);var getAllRequest=store.getAll();getAllRequest.onsuccess=function(){resolve(getAllRequest.result);};});};function getData(start,total){return new Promise(function(resolve,reject){var db=html5rocks.indexedDB.db;var t=db.transaction([DB_NAME],'readonly');var store=t.objectStore(DB_NAME);var transactions=[];var hasSkipped=false;store.openCursor(null,'prev').onsuccess=function(e){var cursor=e.target.result;if(!hasSkipped&&start>0){hasSkipped=true;cursor.advance(start);return;}if(cursor){transactions.push(cursor.value);if(transactions.length<total){cursor.continue();}else{resolve(transactions);}}else{resolve(transactions);}};});}var updateItem=function updateItem(item){return addItem(item);};export{open,addItem,getItems,deleteItem,updateItem,getData};","map":{"version":3,"names":["html5rocks","DB_VERSION","DB_NAME","indexedDB","db","onerror","e","console","log","open","Promise","resolve","reject","request","onupgradeneeded","target","result","transaction","objectStoreNames","contains","deleteObjectStore","createObjectStore","keyPath","onsuccess","Error","addItem","item","trans","store","objectStore","put","deleteItem","id","delete","getItems","getAllRequest","getAll","getData","start","total","t","transactions","hasSkipped","openCursor","cursor","advance","push","value","length","continue","updateItem"],"sources":["/Users/maksym/Desktop/budjet_app/src/utils/indexdb.js"],"sourcesContent":["const html5rocks = {};\nconst DB_VERSION = 1;\nconst DB_NAME = 'budget';\n\nhtml5rocks.indexedDB = {};\nhtml5rocks.indexedDB.db = null;\n\nhtml5rocks.indexedDB.onerror = function(e) {\n  console.log(e);\n};\n\nfunction open() {\n    return new Promise(function(resolve, reject) {\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n        // We can only create Object stores in a versionchange transaction.\n        request.onupgradeneeded = function(e) {\n            const db = e.target.result;\n\n            // A versionchange transaction is started automatically.\n            e.target.transaction.onerror = html5rocks.indexedDB.onerror;\n\n            if(db.objectStoreNames.contains(DB_NAME)) {\n            db.deleteObjectStore(DB_NAME);\n            }\n\n            db.createObjectStore(DB_NAME, {keyPath: \"id\"});\n        };\n\n        request.onsuccess = function(e) {\n            html5rocks.indexedDB.db = e.target.result;\n            resolve()\n        };\n\n        request.onerror = (e) => {\n            reject(Error(e))\n        };\n    })\n};\n\nfunction addItem(item) {\n  return new Promise((resolve, reject) => {\n    const db = html5rocks.indexedDB.db;\n    const trans = db.transaction([DB_NAME], \"readwrite\");\n    const store = trans.objectStore(DB_NAME);\n\n    const request = store.put(item);\n\n    request.onsuccess = function(e) {\n      resolve()\n    };\n\n    request.onerror = function(e) {\n      reject(e)\n    };\n  })\n};\n\nfunction deleteItem(id) {\n  return new Promise((resolve, reject) => {\n    const db = html5rocks.indexedDB.db;\n    const trans = db.transaction([DB_NAME], \"readwrite\");\n    const store = trans.objectStore(DB_NAME);\n  \n    const request = store.delete(id);\n  \n    request.onsuccess = function(e) {\n      resolve()\n    };\n  \n    request.onerror = function(e) {\n      reject(e);\n    };\n  })\n};\n\nfunction getItems() {\n    return new Promise((resolve, reject) => {\n        var db = html5rocks.indexedDB.db;\n        if (!db) {\n            reject(Error('No db'))\n        }\n        var trans = db.transaction([DB_NAME], \"readwrite\");\n        var store = trans.objectStore(DB_NAME);\n\n        const getAllRequest = store.getAll();\n\n        getAllRequest.onsuccess = function() {\n            resolve(getAllRequest.result);\n        }\n    })\n};\n\nfunction getData(start,total) {\n\n\treturn new Promise(function(resolve, reject) {\n    var db = html5rocks.indexedDB.db;\n\t\tvar t = db.transaction([DB_NAME],'readonly');\n\t\tvar store = t.objectStore(DB_NAME);\n\t\tvar transactions = [];\n    var hasSkipped = false;\n    \n\t\tstore.openCursor(null, 'prev').onsuccess = function(e) {\n\n\t\t\tvar cursor = e.target.result;\n\t\t\tif(!hasSkipped && start > 0) {\n\t\t\t\thasSkipped = true;\n\t\t\t\tcursor.advance(start);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(cursor) {\n\t\t\t\ttransactions.push(cursor.value);\n\t\t\t\tif(transactions.length < total) {\n\t\t\t\t\tcursor.continue();\n\t\t\t\t} else {\n\t\t\t\t\tresolve(transactions);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(transactions);\n\t\t\t}\n\t\t};\n\n\t});\n\n}\n\nconst updateItem = (item) => addItem(item);\n\nexport {\n    open,\n    addItem,\n    getItems,\n    deleteItem,\n    updateItem,\n    getData\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}